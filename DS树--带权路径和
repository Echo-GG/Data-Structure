#include <iostream>
#include <vector>
using namespace std;
struct Node{
	Node* left;
	Node* right;
	char data;
	Node(char d):data(d),left(NULL),right(NULL){}	
};

Node* Create(const string& s,int& idx,vector<int>& Leaf_depth,int depth)
{
	if(idx>=s.length())
		return NULL;
	char ch = s[idx++];
	if(ch=='0')
		return NULL;
	Node* root = new Node(ch);
	root->left = Create(s,idx,Leaf_depth,depth+1);
	root->right = Create(s,idx,Leaf_depth,depth+1);
	if(!root->left&&!root->right)
		Leaf_depth.push_back(depth);
	return root;	
}

int main()
{
	int t;
	cin>>t;
	while(t--)
	{
		string s;
		cin>>s;
		int idx = 0;
		int depth = 0;
		int n;
		cin>>n;
		vector<int> weights(n);
		for(int i=0;i<n;i++)
		{
			cin>>weights[i];
		}
		vector<int> Leaf_depth;
		Node* root = Create(s,idx,Leaf_depth,depth);
		int sum = 0;
		for(int i=0;i<Leaf_depth.size();i++)
		{
			sum+=weights[i]*Leaf_depth[i];
		}
		cout<<sum<<endl;
	}
	
	
	return 0;
}
